<div class="container mt-5">
  <!-- Action Buttons -->
  <div class="d-flex flex-wrap justify-content-start mb-4 gap-2">
    <button class="btn btn-success" (click)="addAll()">
      <i class="bi bi-arrow-repeat me-1"></i> Refresh
    </button>
    <button class="btn btn-success" (click)="exportToExcel()">
      <i class="bi bi-filetype-xls me-1"></i> Excel
    </button>
    <button class="btn btn-primary" (click)="openDialog()">
      <i class="bi bi-box-arrow-in-down me-1"></i> Add New Record
    </button>
  </div>

  <!-- Filters -->
  <div class="row mb-4 g-3">
    <div class="col-md-4">
      <div class="form-floating">
        <input 
          type="date" 
          class="form-control" 
          id="date"   
          [(ngModel)]="date"
          
        >
        <label for="date">Filter Date</label>
      </div>
    </div>

    <div class="col-md-4">
      <div class="form-floating">
        <select class="form-select" [(ngModel)]="empId"  name="EmployeeId" >
          <option value="0"  >-- Select Employee --</option>
          <option *ngFor="let emp of empList"  [value]="emp.Id">{{ emp.Name }}</option>
        </select>Ÿç
        <label>Employee</label>
      </div>
    </div>
      <div class="col-md-4">
      <div class="form-floating">
     <button class="btn btn-primary" (click)="filter()">
      <i class="bi bi-filter me-1"></i> Filter
    </button>
      
      </div>
    </div>
  </div>

  <!-- Salary Table -->
  <div class="card shadow-sm border-0">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Employee Salaries</h5>
      <span><strong>Date:</strong> {{ date | date:"MM-yyyy"}}</span>
    </div>

    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-striped table-hover align-middle mb-0">
          <thead class="table-primary">
            <tr>
              <th>#</th>
              <th>Employee</th>
              <th>Month</th>
              <th>Year</th>
              <th>Base Salary</th>
              <th>Deduction</th>
              <th>Net Salary</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let sal of salaryList; let i = index;" class="table-light">
              <td>{{ i + 1 }}</td>
              <td>{{ sal.EmployeeName }}</td>
              <td>{{ sal.Month }}</td>
              <td>{{ sal.Year }}</td>
              <td>{{ sal.BaseSalary | currency:'JOD':'symbol':'1.0-0' }}</td>
              <td>{{ sal.Deduction | currency:'JOD':'symbol':'1.0-0' }}</td>
              <td class="fw-bold text-success">{{ sal.NetSalary | currency:'JOD':'symbol':'1.0-0' }}</td>
              <td class="text-center">
                <button class="btn btn-sm btn-danger" (click)="openDelete(sal.Id)">
                  <i class="bi bi-trash"></i>
                </button> 
                 <button class="btn btn-sm btn-warning m-1" (click)="generateEmployeePDF(sal)">
                      <i class="bi bi-filetype-pdf"></i>
                    </button>
                    </td>
            </tr>
          </tbody>

          <tr *ngIf="!salaryList || salaryList.length === 0">
          <td colspan="8" class="text-center py-3">No Data Found</td>
  </tr>

          <tfoot class="table-secondary">
            <tr>
              <td colspan="8" class="text-end pe-4">
                <strong>Total : {{ totalMonth | currency:'JOD':'symbol':'1.0-0' }}</strong>
              </td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>
</div>
<!-- PDF Template -->
<div id="salaryTemplate" style="visibility: hidden; position: absolute; left: -9999px;">
  <div style="font-family: Arial; padding: 25px;">
    <h1 style="text-align:center; color:#2c3e50; margin-bottom:5px;">
      Employees Management
    </h1>
    <h3 style="text-align:center; color:#555; margin-top:0;">Salary Report</h3>
    <hr style="border:1px solid #2c3e50; margin-bottom:20px;" />

    <p><b>Employee Name:</b> {{ selectedSalary?.EmployeeName }}</p>
    <p><b>Month:</b> {{ selectedSalary?.Month }}</p>
    <p><b>Year:</b> {{ selectedSalary?.Year }}</p>

    <table border="1" cellspacing="0" cellpadding="10" width="100%" style="border-collapse:collapse; font-size:14px; margin-top:15px;">
      <thead style="background-color:#2c3e50; color:white;">
        <tr>
          <th>Detail</th>
          <th>Amount (JOD)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Base Salary</td>
          <td>{{ selectedSalary?.BaseSalary }}</td>
        </tr>
        <tr>
          <td>Deduction</td>
          <td>{{ selectedSalary?.Deduction }}</td>
        </tr>
        <tr style="background-color:#ecf0f1;">
          <td><b>Net Salary</b></td>
          <td><b>{{ selectedSalary?.NetSalary }}</b></td>
        </tr>
      </tbody>
    </table>

    <p style="margin-top:30px; font-size:12px; text-align:right;">
      Generated on {{ today | date :'medium' }}
    </p>
  </div>
</div>
